<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Futterrechner ‚Äì TESTVERSION Sortieren</title>

<style>
body{font-family:Arial;margin:0;background:#eef1f4}
header{background:#2f3b45;color:#fff;padding:12px;text-align:center;font-size:20px}
.tabs{display:flex}
.tab{flex:1;padding:12px;text-align:center;background:#d5dbe0;cursor:pointer}
.tab.active{background:#2f3b45;color:#fff}
.panel{padding:12px}
.hidden{display:none}

.category{background:#fff;border-radius:10px;margin-bottom:16px;padding:10px}
.row{display:flex;align-items:center;gap:6px;margin:4px 0}
.row span{flex:1}
.sort-btn{padding:4px 8px}
.arrow{padding:2px 6px}

input{width:70px}
</style>
</head>

<body>

<header>üêÑ Futterrechner ‚Äì TEST Sortieren</header>

<div class="tabs">
  <div class="tab active" onclick="showTab('calc')">Rechner</div>
  <div class="tab" onclick="showTab('settings')">Einstellungen</div>
</div>

<div id="calc" class="panel"></div>
<div id="settings" class="panel hidden"></div>

<script>
const CATS = ["K√ºhe","Bullen","Trockensteher"];

let data = JSON.parse(localStorage.getItem("test_sort")) || {
  cats: CATS.map(name=>({
    name,
    sort:false,
    items:[
      {id:"f1",name:"Futter 1",kg:1},
      {id:"f2",name:"Futter 2",kg:1},
      {id:"f3",name:"Futter 3",kg:1},
      {id:"f4",name:"Futter 4",kg:1},
      {id:"f5",name:"Futter 5",kg:1},
      {id:"f6",name:"Futter 6",kg:1},
      {id:"f7",name:"Futter 7",kg:1},
      {id:"f8",name:"Futter 8",kg:1},
      {id:"agf",name:"AGF",kg:1},
      {id:"mlf",name:"MLF",kg:1}
    ]
  }))
};

function save(){localStorage.setItem("test_sort",JSON.stringify(data))}

function showTab(t){
  calc.classList.toggle("hidden",t!=="calc");
  settings.classList.toggle("hidden",t!=="settings");
  document.querySelectorAll(".tab").forEach(e=>e.classList.remove("active"));
  document.querySelector(`.tab[onclick*=${t}]`).classList.add("active");
}

function move(cat,i,dir){
  const a=cat.items;
  const ni=i+dir;
  if(ni<0||ni>=a.length)return;
  [a[i],a[ni]]=[a[ni],a[i]];
  save();render();
}

function render(){
  calc.innerHTML="";
  settings.innerHTML="";

  data.cats.forEach((cat,ci)=>{
    let c=document.createElement("div");
    c.className="category";
    c.innerHTML=`<h3>${cat.name}
      <button class="sort-btn" onclick="data.cats[${ci}].sort=!data.cats[${ci}].sort;save();render()">Sortieren</button>
    </h3>`;

    cat.items.forEach((it,i)=>{
      let r=document.createElement("div");
      r.className="row";
      r.innerHTML=`
        <span>${it.name}</span>
        ${cat.sort?`<button class="arrow" onclick="move(data.cats[${ci}],${i},-1)">‚ñ≤</button>
        <button class="arrow" onclick="move(data.cats[${ci}],${i},1)">‚ñº</button>`:""}
      `;
      c.appendChild(r);
    });
    calc.appendChild(c);

    let s=document.createElement("div");
    s.className="category";
    s.innerHTML=`<h3>${cat.name} ‚Äì Einstellungen</h3>`;
    cat.items.forEach(it=>{
      let r=document.createElement("div");
      r.className="row";
      r.innerHTML=`<span>${it.name}</span>
        <input type="number" value="${it.kg}"
        oninput="it.kg=this.valueAsNumber||0;save()">`;
      s.appendChild(r);
    });
    settings.appendChild(s);
  });
}

render();
</script>
</body>
</html>
